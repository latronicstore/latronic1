<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contact Us - LaTRONIC Store</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Josefin+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
<style>
  body { font-family: 'Josefin Sans', sans-serif; margin:0; padding:0; background:#111; color:#f5f5f5; }
  header { background:#000; color:#ff6600; padding:20px; display:flex; align-items:center; justify-content:center; }
  header h1 { font-family: 'Bebas Neue', cursive; font-size:2rem; margin:0; }
  main { max-width:700px; margin:40px auto; padding:0 20px; }
  h2 { font-family: 'Bebas Neue', cursive; margin-top:30px; color:#ff6600; }
  p { line-height:1.6; margin-bottom:15px; }
  form { display:flex; flex-direction:column; background:#1a1a1a; padding:20px; border-radius:10px; box-shadow:0 0 10px rgba(255,102,0,0.4); }
  label { margin-top:10px; margin-bottom:5px; }
  input, textarea { padding:10px; border:1px solid #444; border-radius:5px; font-family:inherit; background:#222; color:#f5f5f5; }
  input:focus, textarea:focus { border-color:#ff6600; outline:none; }
  button { margin-top:15px; padding:12px; background:#ff6600; color:#111; font-family: 'Bebas Neue', cursive; font-size:1rem; border:none; border-radius:5px; cursor:pointer; transition:0.3s; }
  button:hover { background:#ff8533; }
  .back-home { display: inline-block; margin: 40px auto; padding: 14px 28px; background: #ff6600; color: #111; font-family: 'Bebas Neue', cursive; font-size: 1.2rem; text-transform: uppercase; text-decoration: none; border-radius: 8px; transition: all 0.3s ease; text-align: center; }
  .back-home:hover { background: #e65c00; color: #fff; transform: scale(1.05); box-shadow: 0 4px 12px rgba(0,0,0,0.4); }
  .button-container { text-align: center; }
  #form-status { margin-top: 15px; text-align:center; font-weight:bold; }
  #form-status.success { color: #0f0; }
  #form-status.error { color: #f00; }
  .offer-fields { display:none; margin-top:10px; }
</style>
</head>
<body>

<header>
  <h1>LaTRONIC Contact</h1>
</header>

<main>
  <h2>Contact Us / <i class="fas fa-staylinked    "></i> an Offer</h2>
  <p>Fill out the form below to send a message or make an special offer!</p>
  
  <form id="contact-form">
    <label for="name">Name:</label>
    <input type="text" id="name" name="name" required>

    <label for="email">Email:</label>
    <input type="email" id="email" name="email" required>

    <label for="message">Message:</label>
    <textarea id="message" name="message" rows="5" placeholder="Optional if you just want an offer"></textarea>

    <label>
      <input type="checkbox" id="want-offer" /> I want to make an offer
    </label>

    <div class="offer-fields" id="offer-fields">
      <label for="producto">Product:</label>
      <input type="text" id="producto" name="producto" placeholder="Product name">

      <label for="oferta">Offer:</label>
      <input type="text" id="oferta" name="oferta" placeholder="Offer details">
    </div>

    <button type="submit">Send</button>
    <div id="form-status"></div>
  </form>
</main>

<div class="button-container">
  <a href="shop.html" class="back-home">⬅ Back to Main Page</a>
</div>

<script>
  const checkbox = document.getElementById("want-offer");
  const offerFields = document.getElementById("offer-fields");

  checkbox.addEventListener("change", () => {
    offerFields.style.display = checkbox.checked ? "block" : "none";
  });

  document.getElementById("contact-form").addEventListener("submit", async (e) => {
  e.preventDefault();
  const statusEl = document.getElementById("form-status");
  statusEl.textContent = "Sending...";
  statusEl.className = "";

  const data = {
    name: e.target.name.value.trim(),
    email: e.target.email.value.trim(),
    message: e.target.message.value.trim(),
    producto: e.target.producto.value.trim(),
    oferta: e.target.oferta.value.trim()
  };

  try {
    let endpoint = "/api/contact";
    const body = { name: data.name, email: data.email, message: data.message };

    if(checkbox.checked && data.producto && data.oferta) {
      endpoint = "/api/send-offer";
      body.producto = data.producto;
      body.oferta = data.oferta;
    }

    const res = await fetch(endpoint, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body)
    });

    if(!res.ok) throw new Error(`Server responded with status ${res.status}`);
    const result = await res.json();

    if(result.success) {
      statusEl.textContent = "✅ Sent successfully!";
      statusEl.className = "success";
      e.target.reset();
      offerFields.style.display = "none";

      // Redirigir automáticamente al shop
      setTimeout(() => {
        window.location.href = "shop.html";
      }, 2000);
    } else {
      statusEl.textContent = result.error || "❌ There was an error sending.";
      statusEl.className = "error";
    }
  } catch(err) {
    console.error(err);
    statusEl.textContent = "❌ There was an error sending.";
    statusEl.className = "error";
  }
});

</script>

</body>
</html>
